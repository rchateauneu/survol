<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Use Case: Windows Explorer</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
     <link href="css/font-awesome.min.css" rel="stylesheet">
     <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
     <link href="css/style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
  <!--- top bar -->
     <div class="topbar thetop">
      <div class="container">
        <div class="row">
        	<div class="col-md-6 col-sm-8 col-xs-12 left-part">
            	<span class="phone"><i class="fa fa-phone"></i> <a href="tel:+447769516770" class="no-deco">+44 77 6951 6770</a></span>
                <span class="email"><i class="fa fa-envelope"></i> <a href="mailto:contact@primhillcomputers.com" class="no-deco">contact@primhillcomputers.com</a></span>
            </div>
                        <div class="col-md-6 col-sm-4 col-xs-12 right-part">
            	<ul class="hrlist social-icons">
                <li><a href="javascript:void()"><i class="fa fa-facebook"></i></a></li>
                <li><a href="javascript:void()"><i class="fa fa-twitter"></i></a></li>
                <li><a href="javascript:void()"><i class="fa fa-google-plus"></i></a></li>
                <li><a href="javascript:void()"><i class="fa fa-linkedin"></i></a></li>
                </ul>
            </div>

        </div>
      </div>
     </div>
     <!-- End -->
      <!--- navigation -->
    <div class="container">    
     <nav class="navbar navbar-default nav-def">
    		<!-- Brand and toggle get grouped for better mobile display -->
    
     <a href="index.html" class="nav-logo"><img src="images/logo.png" class="img-responsive"></a>
    
 		   <div class="navbar-header">
        <button type="button" data-target="#navbarCollapse" data-toggle="collapse" class="navbar-toggle">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
      
       
    </div>    <!-- Collection of nav links and other content for toggling -->

    	<div id="navbarCollapse" class="collapse navbar-collapse">
       		<ul class="nav navbar-nav navbar-right pad-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="solutions.html">Solutions</a></li>
        <li><a href="survol.html">Survol</a></li>
        <li><a href="faq.html">Survol Faq</a></li>
        <li><a href="architecture.html">Survol Architecture</a></li>
        <li><a href="installation.html">Survol Installation</a></li>
        <li class="active"><a href="usecase.html">Survol Use Cases</a></li>
        <li><a href="contact.html">Contact Us</a></li>        
      </ul>
    	</div>
	</nav>
	</div>
<!-- End -->
<!-- breadcrum section -->
<div class="breadcrum-sec">
 <div class="container">
 	<div class="row">
    	<div class="col-lg-6 col-md-7 col-sm-6 col-xs-12">
        <h1 class="page-title">Windows Explorer</h1>
        </div>
        <div class="col-lg-6 col-md-5 col-sm-6 col-xs-12">
<ul class="breadcrumb">
	<li><a href="index.html">Home</a></li>
	<li><a href="usecase.html">Survol Usecase</a></li>
	<li class="active">Windows Explorer ™</li>
</ul>
        </div>
    </div>
 </div>
</div>

<!-- end -->
<!-- about US -->
    	<section class="white-sec">
    <div class="container">
    	<div class="row">
    <div class="col-lg-3 col-md-4 col-sm-12 col-xs-12">
    	<div class="we-img1 img-left-res">
    	   <img src="images/Windows_explorer_process.PNG" class="img-responsive img-outline">
    	</div>
    </div>
        <div class="col-lg-9 col-md-8 col-sm-12 col-xs-12">
       <h2 class="sec-head text-left">SURVOL USECASE : <SPAN>WINDOWS EXPLORER™</SPAN></h2>
       <div class="about-img"><img src="images/about-line.png"></div>
        <div class="par p-t-0">
              <p class="infotxt big">This investigation scenario is done on a plain Windows machine, where the file Explorer is always available. The goal is to grab as much information as possible about the internal behaviour of a well-known executable. The image are taken from the static SVG output, as it is more stable to copy/paste. This is a simple experiment on a process whose side effects and interactions with other resources are more or less known in advance, and quite simple. Please note that, no command has to be entered, and no specific knowledge in IT is necessary.</p>
        </div>
        </div>
    </div>
    <div class="row">
    <div class="col-md-12 col-xs-12">
    <p class="infotxt big">The first step is to find the process using the "Process tree" script (enumerate_CIM_Process.py). In the graph of processes and subprocesses, because it is a SVG document, one can use the Browser "find" usual command to find one or several processes running "explorer.exe", but it is also possible to scroll in the graph. This object is of the CIM class CIM_Process. To be exact, this is a subclass of this class.</p>
    </div>
    </div>
    
        </div>
        </section>
        
   		<section class="grey-sec">
     <div class="container">
    <div class="row">
    	<div class="col-xs-12">
    <p class="sec-subhead big text-center">
    Several scripts are available to run on this process. Only the scripts which can run on a Windows machine are displayed.
    </p>
    </div>
    <div class="col-xs-12 text-center">
    <img src="images/Available_scripts.PNG" class="img-responsive img-center" alt="available scripts">
    </div>
    </div>
    </div>
    </section>   
    
        <section class="white-sec">
          <div class="container">
           <div class="row">             
             <div class="col-md-9 col-xs-12">
             <p class="infotxt big">Of course, the scripts related to Java processes are not worth being called, as Explorer is written only in C. Still, a C process could call Java libraries, therefore in some tituations these scripts are usable.</p>
             <p class="infotxt big">The scripts in the folder "Regex matching in heap" scan the memory process to detect some specific strings, using regular expressions. Let's have a look to some of the HTTP urls this process contains. It is not entirely clear why this and that URL appears in the process memory.</p>
             <p class="infotxt big">URLs do not have a class name in the CIM terminology. This is not a difficulty for Survol which very easily adds its own classes to CIM ones: Each Survol class is a Python module, with very few requirements.</p>
             </div>
             <div class="col-md-3 col-xs-12">
             <img src="images/urls.PNG" class="img-center img-responsive" />
             </div>
           </div>
          </div>
        </section>
        
        <section class="grey-sec">
          <div class="container">
           <div class="row">             
             <div class="col-md-3 col-xs-12">
             <img src="images/Tortoise.PNG" class="img-responsive img-center" />
             </div>
             <div class="col-md-9 col-xs-12">
             <p class="infotxt big">The script displaying sockets does not return anything. On the other hand, the list of memory mapped-files is really huge; It would be nice to display them in a list instead of a graph. Several of them related to TortoiseSVN and TortoiseGIT, for example this library. </p>
             </div>
           </div>
           <div class="row m-t-10">
           <div class="col-md-12 col-xs-12">
              <p class="infotxt big">We will see why we think it is dynamically loaded. Memory-mapped files are a different entity than plain files, because they convey more information such as the amount of memory mapped, the addresses etc... Still, there is a one-to-one correspondance with their data file names, which is why they have the same name.</p>
             </div>
             </div>
          </div>
        </section>
        
        <section class="white-sec">
          <div class="container">
           <div class="row">             
             <div class="col-md-12 col-xs-12">
             <p class="infotxt big">It is not uninteresting to see that this DLL is also opened by several processes. But why does Snipping Tool accesses this DLL ? This can only be an indirect load because it is not part of the static dependency of this executable. It is of course possible to click on each process or any other resource to have a better idea of possible interactions.</p>
<p class="sec-subhead big text-center">One can see the associated CIM_DataFile object associated to the mapped file. It has a standard CIM class.
</p>
             </div>
             <div class="col-md-12 col-xs-12">
             <img src="images/ProcTortoise.PNG" class="img-responsive img-center" />
             </div>
           </div>
          </div>
        </section>
        
        <section class="grey-sec">
          <div class="container">
           <div class="row">             
             <div class="col-md-8 col-xs-12">
             <p class="infotxt big">Back to Windows Explorer. Which file does it open ? Unsurprisingly, cache files containing icons, if we believe the hint given by their names. At the moment, there is no script to decode these (They are no SQLLite database files despite the extensions).</p>
             </div>
             <div class="col-md-4 col-xs-12">
             <img src="images/open_files.PNG" class="img-responsive img-center" />
             </div>
           </div>
          </div>
        </section>
        
        <section class="white-sec">
          <div class="container">
           <div class="row">             
             
             <div class="col-md-4 col-xs-12">
             <img src="images/files_in_heap.PNG" class="img-center img-responsive" />
             </div>
             
             <div class="col-md-8 col-xs-12">
             
             <p class="infotxt big m-t-10">Without too much surprise, we can see the file names contained in the memory process. We can find the files which are currently being displayed in the user interface and, of course, their names appear in the heap.<p>
             <p class="infotxt big m-t-10"> What is more interesting is that they apparently are not stored in a process cache, but simply resides in the operating system memory. A possible explanation is that Explorer would use the Operating System cache.</p>
<p class="infotxt big m-t-10">By default, the script selects only the filenames whose file actually exist. So it is possible to click on each filename and investigate further, or simply display it if it has a MIME type. But it is possible to toggle this flag, and in this case non-existent filenames will be displayed.</p>
<p class="infotxt big m-t-10">The logic of searching the process memory for specific patterns is very easy to extend to new expressions. At the moment, this can detect SQL queries, HTTP URLs, ODBC connections strings, file names and COM classes, once a specific characters patterns is defined.</p>

             
             </div>
             
           </div>
          </div>
        </section>

        <section class="grey-sec">
          <div class="container">
           <div class="row">             
             <div class="col-md-12 col-xs-12">
             <p class="sec-subhead big">Now, let's have a look at the executable file itself, and the possibilities offered by Survol:</p>
                          <p class="infotxt big">Of course, the scripts related to Java processes are not worth being called, as Explorer is written only in C. Still, a C process could call Java libraries, therefore in some tituations these scripts are usable.</p>

             </div>
             <div class="col-md-12 col-xs-12">
             <img src="images/executable_scripts.PNG" class="img-responsive img-center" />
             </div>
           </div>
          </div>
        </section>
        
        <section class="white-sec">
          <div class="container">
           <div class="row">             
             <div class="col-md-9 col-xs-12">
             <p class="infotxt big">Explorer.exe contains several icons ... This is not a very useful information in itself, but the methodology can be extended to extract any type of information from a CIM_Datafile object.</p>
             </div>
             <div class="col-md-3 col-xs-12">
             <img src="images/Explorer_icons.PNG" class="img-center img-responsive" />
             </div>
             
             
             
           </div>
          </div>
        </section>

        <section class="grey-sec">
          <div class="container">
           <div class="row">     
           <div class="col-md-4 col-xs-12">
             <img src="images/Import_Symbols.PNG" class="img-responsive img-center" />
             </div>        
             <div class="col-md-8 col-xs-12">
                          <p class="infotxt big">There is also a script which displays the complete graph of DLLs (Dynamic Link Library) and imported symbols from a PE (Portable Executable format) file. This is quite heavy but is exhaustive, and for example shows that the Tortoise library can only have been loaded dynamically, as it cannot be found here.</p>

<p class="infotxt big">Each DLL listed in this diagram can be further browsed by clicking on it. Also, each symbol of each DLL can also be explored, because it is an object type with its properties and scripts.</p>

<p class="infotxt big">A future plan is to disassemble the code of each entry point, to extract the call graph (Internal jumps and calls to external functions), but this is not available yet. </p>
</p>

             </div>
             
           </div>
          </div>
        </section>


<!-- end -->


<!-- ==== Footer ==== -->
   
    <section class="footer">
    <div class="container">
    <div class="col-md-4 col-sm-4 col-xs-12">
    <div class="footer-logo"><img src="images/footer-logo.png" class="img-responsive"></div>
    </div>
      <div class="col-md-4 col-sm-4 col-xs-12">
      <div class="useful">Useful links</div>
      	<div class="row">

      <div class="col-md-6 col-sm-6 col-xs-12">
      <div class="useful-link">
      <ul>
      <li>
      <a href="index.html"><i class="fa fa-angle-right"></i> Home</a>
      </li>
      <li>
      <a href="solutions.html"><i class="fa fa-angle-right"></i> Solutions</a>
      </li>
      <li>
      <a href="survol.html"><i class="fa fa-angle-right"></i> Survol</a>
      </li>
      <li>
      <a href="faq.html"><i class="fa fa-angle-right"></i> Survol Faq</a>
      </li>
      </ul>
      </div>
      </div>
        <div class="col-md-6 col-sm-6 col-xs-12">
      <div class="useful-link">
      <ul>
      <li>
      <a href="architecture.html"><i class="fa fa-angle-right"></i> Survol Architecture</a>
      </li>
      <li>
      <a href="installation.html"><i class="fa fa-angle-right"></i> Survol Installation</a>
      </li>
      <li>
      <a href="survol.html"><i class="fa fa-angle-right"></i> Survol Use Cases</a>
      </li>
      <li>
      <a href="contact.html"><i class="fa fa-angle-right"></i> Contact Us</a>
      </li>
      </ul>
      </div>
      </div>
              </div>
      </div>
      <div class="col-md-4 col-sm-4 col-xs-12">
            <div class="contact-us">Contact us</div>
            <div class="address-map"> <i class="fa fa-map-marker"></i> Primhill Computers: 275, Boston Manor Road, TW8 9LG Brentford, United Kingdom</div>
            <div class="address-map"> <i class="fa fa-envelope"></i> Email : <a href="mailto:contact@primhillcomputers.com" class="a-link">contact@primhillcomputers.com</a></div>
            <div class="address-map"> <i class="fa fa-phone"></i> Phone Number : <a href="tel:+447769516770" class="a-link">+44 77 6951 6770</a></div>
            </div>
            </div>
    </section>
    <!-- End -->

    <div class="bottotop">
<div class='scrolltop'>
    <div class='scroll icon'><i class="fa fa-arrow-up"></i></div>
</div>
    </div>
    
    <section class="footer-bottom">
    <div class="copyright">Copyright 2018 All Right Reserved | <b>Primhill Computers</b></div>
    </section>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
        
    <script>
    $(window).scroll(function() {
    if ($(this).scrollTop() > 50 ) {
        $('.scrolltop:hidden').stop(true, true).fadeIn();
    } else {
        $('.scrolltop').stop(true, true).fadeOut();
    }
});
$(function(){$(".scroll").click(function(){$("html,body").animate({scrollTop:$(".thetop").offset().top},"1000");return false})})
    </script>

  </body>
</html>